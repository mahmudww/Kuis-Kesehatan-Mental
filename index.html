<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cek Kesejahteraan Mental Diri: Cepat & Akurat</title>
    <style>
        /* CSS untuk Kuis Serius */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f7f7f7; 
            color: #333;
            min-height: 100vh;
            position: relative; 
        }

        /* üö® Kunci Layar saat Transisi untuk Mencegah Scroll Jump */
        .scroll-lock {
            overflow: hidden;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            z-index: 9999; 
        }
        
        .quiz-container {
            width: 90%;
            max-width: 650px;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            
            /* Absolute Centering yang stabil */
            position: absolute;
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            z-index: 10;
        }
        h1 {
            color: #ff6b6b;
            border-bottom: 2px solid #ff6b6b;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        #step-counter {
            font-size: 1em;
            text-align: right;
            color: #555;
            margin-bottom: 15px;
        }
        #question-text {
            font-size: 1.3em;
            margin-bottom: 25px;
            font-weight: 600;
            text-align: left;
            padding: 10px;
            border-left: 5px solid #4ecdc4;
            /* Transisi 0.5s */
            transition: opacity 0.5s ease-in-out; 
        }
        /* Style untuk Gambar Pertanyaan (Rata Tengah) */
        #question-image {
            width: 100%; 
            max-width: 400px; 
            height: auto; 
            margin: 0 auto 20px auto;
            display: block;
            border-radius: 8px;
            /* Transisi 0.5s */
            transition: opacity 0.5s ease-in-out;
        }

        .choice-btn {
            display: block;
            width: 100%; 
            padding: 15px;
            margin-bottom: 12px;
            background-color: #f0f0f0;
            color: #333;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.15s, border-color 0.15s, opacity 0.5s ease-in-out;
            text-align: left;
        }

        .choice-btn:hover {
            background-color: #e9ecef;
            border-color: #ff6b6b;
            color: #ff6b6b;
        }

        /* Class untuk Konfirmasi Klik (UX Smartphone) */
        .choice-btn.clicked {
            background-color: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }

        /* Container choices perlu property agar height bisa diatur oleh JS */
        #choices-container {
            min-height: 10px;
        }
        
        #quiz-screen, #result-screen {
            display: none;
        }
        #result-screen h2 {
            color: #28a745;
            margin-top: 0;
        }
        /* ... CSS Lainnya ... */
        .score-item strong {
            display: inline-block;
            min-width: 150px;
        }
        .low { border-left-color: #28a745; }
        .moderate { border-left-color: #ffc107; }
        .high { border-left-color: #dc3545; }
        .score-footer {
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
            text-align: left;
            font-size: 0.95em;
            color: #6c757d;
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <h1>üå± Cek Kesejahteraan Mental Diri: Kamu Butuh Bantuan?</h1>

    <div id="intro-screen">
        <p style="font-size: 1.1em; text-align: left;">Hai! Kuis ini dibuat untuk bantu kamu kenalan lebih dekat sama kondisi mentalmu. Kami akan identifikasi area yang mungkin butuh perhatian.</p>
        <p style="font-size: 1.1em; text-align: left; font-weight: bold; color: #ff6b6b;">üìù Jawab dengan jujur dan cepat. Kuis ini hanya butuh waktu <strong>KURANG DARI 3 MENIT!</strong></p>
        <p style="font-size: 0.9em; margin-top: 20px; text-align: left; color: #6c757d;">Penting: Kuis ini hanya alat bantu <i>self-awareness</i> dan bukan pengganti diagnosa profesional.</p>
        <button id="start-button" class="choice-btn" style="text-align: center; background-color: #ff6b6b; color: white; margin-top: 30px;">Mulai Cek Kondisi Mental (3 Menit)</button>
    </div>

    <div id="quiz-screen">
        <p id="step-counter">...</p>
        <img id="question-image" src="" alt="Ilustrasi Pertanyaan"> 
        
        <p id="question-text">Memuat pertanyaan...</p>
        
        <div id="choices-container">
        </div>
    </div>

    <div id="result-screen">
        <h2>‚ú® Hasil Cek Profil Kamu</h2>
        <p>Oke, ini dia ringkasan kebutuhan dukungan kamu berdasarkan 20 jawaban tadi:</p>
        
        <div id="score-summary">
        </div>

        <div class="score-footer">
            <p>Penting: Kalau kamu dapat skor Sedang atau Tinggi di salah satu kategori, itu tandanya kamu butuh waktu istirahat lebih atau mungkin sudah saatnya ngobrol dengan profesional (psikolog/terapis) ya. <i>It's okay to ask for help!</i></p>
        </div>
        <button class="choice-btn" onclick="location.reload()" style="background-color: #4ecdc4; color: white; width: 100%; margin-top: 20px; text-align: center;">Coba Lagi / Mulai Ulang</button>
    </div>

</div>

<script>
    // --- SKALA JAWABAN ---
    const answerScale = [
        { text: "Gak sama sekali (0 hari)", score: 0 },
        { text: "Beberapa hari aja", score: 1 },
        { text: "7 hari atau lebih", score: 2 },
        { text: "Hampir setiap hari", score: 3 }
    ];

    // --- PERTANYAN (SEMUA JALUR MENGGUNANAKAN .jpeg) ---
    // üö® PERBAIKAN V31: Pertanyaan dipertajam untuk membedakan kategori
    const questions = [
        // DEPRESI
        { category: "Depresi", text: "merasa sangat sedih, muram, atau putus asa (termasuk perasaan tidak berharga)?", image: "./images/q1.jpeg" }, 
        { category: "Depresi", text: "kehilangan minat yang besar atau gak lagi menikmati kegiatan yang dulu disukai?", image: "./images/q2.jpeg" },
        { category: "Depresi", text: "merasa energi sangat menurun atau hampir selalu mengalami keletihan fisik yang gak hilang setelah istirahat?", image: "./images/q3.jpeg" },
        { category: "Depresi", text: "mengalami perubahan signifikan pada pola tidur (misalnya, insomnia, atau hipersomnia)?", image: "./images/q4.jpeg" },
        { category: "Depresi", text: "merasa bersalah yang berlebihan atau yakin kamu adalah orang yang gagal secara keseluruhan?", image: "./images/q5.jpeg" },
        
        // KECEMASAN
        { category: "Kecemasan", text: "merasa gelisah atau tidak bisa diam, seolah ada bahaya yang akan datang?", image: "./images/q6.jpeg" },
        { category: "Kecemasan", text: "sulit mengendalikan kekhawatiran yang mengganggu (seperti ketakutan tidak rasional) yang muncul terus-menerus?", image: "./images/q7.jpeg" },
        { category: "Kecemasan", text: "merasa otot tegang, jantung berdebar, atau mengalami gejala fisik lain saat merasa cemas?", image: "./images/q8.jpeg" },
        { category: "Kecemasan", text: "merasa pikiran kosong, gak fokus, atau kesulitan mengambil keputusan karena cemas?", image: "./images/q9.jpeg" },
        { category: "Kecemasan", text: "merasa khawatir akan peristiwa kecil yang mungkin terjadi dan tidak bisa menghentikannya?", image: "./images/q10.jpeg" },

        // STRES
        { category: "Stres", text: "merasa tekanan mental saat harus beradaptasi dengan perubahan atau situasi baru?", image: "./images/q11.jpeg" },
        { category: "Stres", text: "merasa hal-hal dalam hidup di luar kendali kamu, sehingga sulit berfungsi normal?", image: "./images/q12.jpeg" },
        { category: "Stres", text: "merasa kesal, marah, atau tertekan karena interaksi dengan orang lain (konflik interpersonal)?", image: "./images/q13.jpeg" },
        { category: "Stres", text: "mengalami sakit kepala, sakit perut, atau pusing yang muncul saat menghadapi tuntutan?", image: "./images/q14.jpeg" }, 
        { category: "Stres", text: "merasa kewalahan oleh semua tuntutan dan tenggat waktu yang menumpuk?", image: "./images/q15.jpeg" },

        // KELELAHAN (BURNOUT)
        { category: "Kelelahan", text: "merasa lelah secara emosional dan fisik akibat pekerjaan/peran kamu sehari-hari?", image: "./images/q16.jpeg" },
        { category: "Kelelahan", text: "merasa sinis, negatif, atau skeptis terhadap rekan kerja/tanggung jawab kamu?", image: "./images/q17.jpeg" },
        { category: "Kelelahan", text: "merasa telah kehilangan efektivitas atau prestasi dalam pekerjaan/aktivitas yang kamu lakukan?", image: "./images/q18.jpeg" },
        { category: "Kelelahan", text: "menarik diri dari interaksi sosial di tempat kerja/lingkungan aktivitas kamu?", image: "./images/q19.jpeg" },
        { category: "Kelelahan", text: "meragukan nilai atau dampak dari pekerjaan/aktivitas yang kamu lakukan sehari-hari?", image: "./images/q20.jpeg" }
    ];

    // --- INTERPRETASI SKOR ---
    const interpretation = {
        Depresi: [
            { threshold: 10, label: "Tinggi", class: "high", recommendation: "Ada kemungkinan gejala Depresi cukup kuat. Jangan tunda, segera cari bantuan profesional untuk evaluasi lebih lanjut." },
            { threshold: 5, label: "Sedang", class: "moderate", recommendation: "Gejala suasana hati cukup terasa. Prioritaskan <i>self-care</i> dan cari tahu apa yang memicu perasaan ini. Ngobrol sama teman supportif bisa bantu." },
            { threshold: 0, label: "Rendah", class: "low", recommendation: "Mood kamu aman terkendali. Lanjutkan kebiasaan baikmu!" }
        ],
        Kecemasan: [
            { threshold: 10, label: "Tinggi", class: "high", recommendation: "Tingkat Kecemasanmu tinggi dan mengganggu aktivitas. Penting banget untuk belajar teknik relaksasi dan pertimbangkan untuk konsultasi." },
            { threshold: 5, label: "Sedang", class: "moderate", recommendation: "Kekhawatiranmu cukup menguras energi. Coba batasi sumber stres (sosial media, berita) dan fokus pada <i>mindfulness</i>." },
            { threshold: 0, label: "Rendah", class: "low", recommendation: "Kamu termasuk orang yang tenang dan gak gampang panik. Nice!" }
        ],
        Stres: [
            { threshold: 10, label: "Tinggi", class: "high", recommendation: "Stresmu sudah di level bahaya! Kamu perlu evaluasi ulang batas (<i>boundary</i>) dan beban kerja/hidupmu. Istirahat jadi prioritas utama." },
            { threshold: 5, label: "Sedang", class: "moderate", recommendation: "Tekanan hidup terasa, tapi masih bisa diatasi. Coba atur jadwal, delegasikan tugas, dan jangan lupa me time." },
            { threshold: 0, label: "Rendah", class: "low", recommendation: "Stres terkendali! Kamu pintar mengatur hidup dan prioritas." }
        ],
         Kelelahan: [
            { threshold: 10, label: "Tinggi", class: "high", recommendation: "Ini bisa jadi tanda Burnout serius. Istirahat total, ambil cuti, dan bicarakan ini dengan atasan/orang terdekat. Jangan paksakan diri." },
            { threshold: 5, label: "Sedang", class: "moderate", recommendation: "Ada kelelahan emosional yang menumpuk. Coba ganti rutinitas, temukan kembali tujuanmu, dan tetapkan batasan waktu kerja yang lebih jelas." },
            { threshold: 0, label: "Rendah", class: "low", recommendation: "Motivasi dan energimu bagus! Pertahankan keseimbangan hidupmu." }
        ]
    };

    let currentStep = 0;
    let scores = { Depresi: 0, Kecemasan: 0, Stres: 0, Kelelahan: 0 };
    
    // Elemen DOM
    const introScreen = document.getElementById('intro-screen');
    const startButton = document.getElementById('start-button');
    const quizScreen = document.getElementById('quiz-screen');
    const questionTextElement = document.getElementById('question-text');
    const questionImageElement = document.getElementById('question-image'); 
    const choicesContainer = document.getElementById('choices-container');
    const stepCounterElement = document.getElementById('step-counter');
    const resultScreen = document.getElementById('result-screen');
    const scoreSummaryElement = document.getElementById('score-summary');

    // --- FUNGSI UTAMA ---

    function startQuiz() {
        introScreen.style.display = 'none';
        quizScreen.style.display = 'block';
        loadStep();
    }

    // Fungsi untuk menampilkan konten (teks dan tombol) setelah gambar siap
    function displayQuestionContent(step) {
        
        const fullQuestionText = `Dalam <strong>dua minggu terakhir</strong>, seberapa sering kamu <strong>${step.text}</strong>`;
        questionTextElement.innerHTML = fullQuestionText;
        
        choicesContainer.innerHTML = ''; 
        
        // 1. Pastikan opacity disetel ke 0 sebelum konten baru dimasukkan (untuk memicu fade-in)
        questionTextElement.style.opacity = '0';
        questionImageElement.style.opacity = '0';

        answerScale.forEach((answer) => {
            const button = document.createElement('button');
            button.className = 'choice-btn';
            button.textContent = answer.text;
            
            button.onclick = () => chooseChoice(answer.score, step.category, button); 
            
            choicesContainer.appendChild(button);
        });

        // 2. KUNCI PERBAIKAN: Gunakan setTimeout 50ms untuk memaksa transisi fade-in
        setTimeout(() => {
            questionTextElement.style.opacity = '1'; 
            
            if (questionImageElement.style.display !== 'none') {
                questionImageElement.style.opacity = '1';
            }
        }, 50); // Jeda sangat singkat (50ms) untuk memicu transisi CSS
    }

    function loadStep() {
        if (currentStep >= questions.length) {
            showFinalResult();
            return;
        }
        
        const step = questions[currentStep];
        
        stepCounterElement.textContent = `Pertanyaan ${currentStep + 1} dari ${questions.length}`;
        
        // KOSONGKAN PILIHAN JAWABAN SEMENTARA
        choicesContainer.innerHTML = ''; 
        
        // 1. TANGANI GAMBAR
        if (step.image) {
            questionImageElement.src = step.image;
            questionImageElement.style.display = 'block';
            
            // TUNGGU GAMBAR SELESAI DI-LOAD
            questionImageElement.onload = () => {
                displayQuestionContent(step);
            };
            // Penanganan jika gambar gagal di-load
            questionImageElement.onerror = () => {
                console.error("Gagal memuat gambar:", step.image);
                displayQuestionContent(step); 
            };
        } else {
            questionImageElement.style.display = 'none';
            // Jika tidak ada gambar, langsung tampilkan konten
            displayQuestionContent(step);
        }
    }

    // Fungsi sekarang menerima elemen tombol (buttonElement) untuk efek klik
    function chooseChoice(score, category, buttonElement) {
        // 1. Terapkan kelas 'clicked' ke tombol yang baru diklik (perubahan warna)
        buttonElement.classList.add('clicked');
        
        // Simpan skor sebelum jeda
        scores[category] += score;

        // KUNCI PERBAIKAN JUMP/REFLOW: Tangkap dan set tinggi container pilihan
        const currentHeight = choicesContainer.offsetHeight;
        choicesContainer.style.height = `${currentHeight}px`;

        // üö® KUNCI LAYAR/SCROLL FIX:
        const scrollPosition = window.scrollY; // Catat posisi scroll saat ini
        document.body.classList.add('scroll-lock'); // Kunci body (position:fixed)
        document.body.style.top = `-${scrollPosition}px`; // Pertahankan posisi visual
        
        // üö® KUNCI PERBAIKAN FLICKERING: Paksa Fade Out di detik ke-0
        questionTextElement.style.opacity = '0';
        questionImageElement.style.opacity = '0';

        // 2. Beri total jeda 900ms (0.4s click feedback + 0.5s fade-out time)
        setTimeout(() => {
            
            // Hapus kelas 'clicked' dari semua tombol
            document.querySelectorAll('.choice-btn').forEach(btn => {
                btn.classList.remove('clicked');
            });

            // KUNCI PERBAIKAN JUMP/REFLOW: Hapus tinggi agar container bisa menampung konten baru
            choicesContainer.style.height = ''; 

            // üö® BUKA KUNCI LAYAR/SCROLL FIX:
            document.body.classList.remove('scroll-lock'); // Lepas kunci body
            document.body.style.top = ''; // Hapus style top
            window.scrollTo(0, scrollPosition); // Kembalikan scroll ke posisi awal
            
            // 3. Lanjutkan ke langkah berikutnya
            currentStep++; 
            loadStep();
        }, 900); // Jeda total 900 milidetik (0.9 detik)
    }
    
    function getInterpretation(category, totalScore) {
        const rules = interpretation[category];
        for (const rule of rules) {
            if (totalScore >= rule.threshold) {
                return rule;
            }
        }
    }

    function showFinalResult() {
        quizScreen.style.display = 'none';
        resultScreen.style.display = 'block';
        
        questionImageElement.style.display = 'none'; 
        
        scoreSummaryElement.innerHTML = '';

        for (const category in scores) {
            const totalScore = scores[category];
            const interpretationData = getInterpretation(category, totalScore);

            const scoreItem = document.createElement('div');
            scoreItem.className = `score-item ${interpretationData.class}`;
            scoreItem.innerHTML = `
                <strong>${category} Score:</strong> <span style="font-weight: bold;">${totalScore}</span> / 15
                <br>
                <span style="font-size: 1em;">
                    Tingkat Kebutuhan Dukungan: <span style="font-weight: bold; color: ${interpretationData.class === 'high' ? '#dc3545' : interpretationData.class === 'moderate' ? '#ffc107' : '#28a745'}">${interpretationData.label}</span>
                </span>
                <p style="font-size: 0.9em; margin-top: 5px; color: #555;">Rekomendasi: ${interpretationData.recommendation}</p>
            `;
            scoreSummaryElement.appendChild(scoreItem);
        }
        
        console.log("Skor Akhir:", scores);
    }

    // MULAI: Panggil startQuiz saat tombol diklik
    startButton.onclick = startQuiz;

</script>

</body>
</html>
